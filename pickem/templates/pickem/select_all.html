{% extends 'pickem/base.html' %}
{% load staticfiles %}

{% block title %}My Picks{% endblock %}

{% block additional_style %}
<link type="text/css" href="{% static 'pickem/css/sortable_selection.css' %}" rel="stylesheet">
{% endblock %}

{% block extra_navbar_right %}
{% if started != True %}
<li><button type="submit" form="rankform" class="mybutton btn btn-primary btn-lg" id="save_button">Save Picks</a></li>
{% endif %}
{% endblock %}

{% block content %}
{% if error %}
<div class="alert alert-danger">
    {{ error }}
</div>
{% endif %}

{% if not started %}
<div class="panel panel-info">
    <div class="panel-heading">How to play</div>
    <div class="panel-body">
        <p>
        For each matchup, select the team you think will win. Your
        selections will be shown in blue. 
        </p>
        <p>
        Each game is assigned a point value which is its position in
        the list.
        You can reorder the games by dragging them up or down the list. Place
        your most confident picks at the top.
        </p>
        <p>
        Hit "Save Picks" in the navigation bar at the top of the page at
        any time to save your work.
        </p>
    </div>
</div>
{% endif %}

{% if started == True %}
<div class="alert alert-danger alert-dismissable" role="alert">
    <button type="button" class="close" data-dismiss="alert">
        <span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
    </button>
    <p><b>Alert:</b> Games have started. You will not be able to submit any
    changes you make.</p>
</div>
{% elif missing_count > 0 %}
<div class="alert alert-warning">
    <p>You still have <b>{{ missing_count }} picks</b> to make!
    </p>
</div>
{% else %}
<div class="alert alert-success">
    <p><b>Well done!</b>
    You've finished your picks for all games. Just make sure you have them in
    the order you want.
    </p>
</div>
{% endif %}

<div class="modal" id="gameinfo" tabindex="-1" role="dialog">
     <div class="modal-dialog">
         <div class="modal-content">
             <div class="modal-header">
                 <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                 <h4 class="modal-title" id="myModalLabel">Modal title</h4>
             </div>
             <div class="modal-body">
                 ...
             </div>
             <div class="modal-footer">
                 <button type="button" class="btn btn-default" data-dismiss="modal">Dismiss</button>
             </div>
         </div>
     </div>
</div>

<form method="POST" action="{% url 'pickem:select_all' %}" id="rankform">
    {% csrf_token %}
    <input type='hidden' name='matchup_ordering' id='matchup_ordering'>
    <div class="pick-list" id="matchup_ranking">
        {% for matchup in selection_form_items %}
        <div class="row" id="game={{matchup.game.id}}">
            <div class="col-xs-4 col-sm-2 handle">
                <div class="row">
                    <div class="col-xs-0 col-sm-4"></div>
                    <div class="col-xs-3 col-sm-2 pick-list-info handle-grip">::</div>
                    <div class="col-xs-3 col-sm-2 pick-list-info pick-idx">{{ forloop.revcounter }}</div>
                    <div class="col-xs-6 col-sm-4 pick-list-info game-info">
                        <button type="button" class="btn btn-default game-info-btn"
                                              data-toggle="modal" data-target="#gameinfo">
                            <span class="glyphicon glyphicon-info-sign"></span>
                        </button>
                    </div>
                </div>
            </div>
            {% for team in matchup.teams %}
            <div class="col-xs-4 button-div pick-list-col">
                    <input type="radio"
                           name="game={{ matchup.game.id }}"
                           value="{{ team.name }}"
                           id="{{ team.name }}"
                    {% if forloop.counter == matchup.checked %}
                    checked="checked"
                    {% endif %}
                    >
                    <label class="team-button" for="{{ team.name }}">
                    {{ team.name }}
                    {% if team.rank %}
                    ({{ team.rank }})
                    {% endif %}
                    </label>
            </div>
            {% endfor %}
        </div>
        {% endfor %}
    </div>
</form>
{% endblock %}

{% block external_js %}
<script type="text/javascript" src="//code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.2/jquery.ui.touch-punch.min.js"></script>
<script type="text/javascript" src="{% static 'pickem/js/select_all_form.js' %}"></script>
{% endblock %}

